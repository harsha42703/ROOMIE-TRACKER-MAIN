<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ROOMIE TRACKER</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
body{background:#000;color:#fff;font-family:sans-serif}
.glass{background:rgba(255,255,255,.08);backdrop-filter:blur(20px);border-radius:18px;padding:14px;margin-bottom:12px}
</style>
</head>
<body class="p-4">

<h1 class="text-2xl text-center mb-4">ROOMIE TRACKER</h1>

<div id="app"></div>

<script>
let sheets=JSON.parse(localStorage.getItem("sheets")||"{}");
let current=null;

function save(){
 localStorage.setItem("sheets",JSON.stringify(sheets));
 render();
}

function newSheet(){
 const name=prompt("Enter Sheet Name");
 if(!name) return;
 sheets[name]={members:[],expenses:[]};
 current=name;
 save();
}

function addMember(){
 const m=prompt("Member name");
 if(!m) return;
 sheets[current].members.push(m);
 save();
}

function splitExpense(){
 const amt=+prompt("Enter Amount");
 if(!amt) return;

 const members=sheets[current].members;
 const split={};
 const share=amt/members.length;

 members.forEach(m=>split[m]=share);

 sheets[current].expenses.push({
  amount:amt,
  paid:members[0],
  split
 });

 save();
}

function balances(){
 const data=sheets[current];
 const b={};
 data.members.forEach(m=>b[m]=0);

 data.expenses.forEach(e=>{
  Object.entries(e.split).forEach(([p,v])=>b[p]-=v);
  b[e.paid]+=e.amount;
 });

 return b;
}

function render(){
 const el=document.getElementById("app");

 if(!current){
  el.innerHTML=`
   <button class="glass w-full" onclick="newSheet()">➕ Create New Sheet</button>
   ${Object.keys(sheets).map(s=>`
    <div class="glass" onclick="current='${s}';render()">${s}</div>
   `).join("")}
  `;
  return;
 }

 const bal=balances();

 el.innerHTML=`
  <div class="glass flex justify-between">
   <b>${current}</b>
   <button onclick="current=null;render()">Back</button>
  </div>

  <button class="glass w-full" onclick="addMember()">Add Member</button>
  <button class="glass w-full" onclick="splitExpense()">Split Expense</button>

  <h3 class="mt-3 mb-2">Balances</h3>

  ${Object.entries(bal).map(([p,v])=>`
   <div class="glass flex justify-between">
    <span>${p}</span>
    <span style="color:${v<0?'red':'lightgreen'}">
     ₹${v.toFixed(2)}
    </span>
   </div>
  `).join("")}
 `;
}

render();
</script>

</body>
</html>